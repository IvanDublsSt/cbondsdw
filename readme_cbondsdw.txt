Модуль cbondsdw предоставляет несколько функций, которые могут быть использованы для сбора данных определенного формата с сайта cbonds. 
*******************************************************************************************************************************************************************************************************************
Технические требования

Для работы с ним потребуется учетная запись на cbonds (по умолчанию все функции используют учетнку автора, но она истекает весной) и 
установленный chromedriver для работы с модулем selenium. Кроме того, понадобятся следующие библиотеки (предварительно установите их, 
если не уверены в их наличии):
selenium
pandas
numpy
os
time
random
PIL
io
urllib.request

*******************************************************************************************************************************************************************************************************************
Функционал: 

Формат данных, которые можно выгружать с помощью модуля: все котировки для каждой из облигаций из заранее подготовленного (пользователем) списка
на указанный диапазон дат (по умолчанию - от 01.01.2015 до 31.12.2020), находящиеся в распоряжении cbonds. Котировки сохраняются браузером в папку для загрузок по умолчанию,
котировки по каждой из облигаций сохраняются отдельным xlsx файлом. Ориентировочное время, затрачиваемое на каждую облигацию - 40 секунд (оценка
консервативная, скорее меньше, чем больше; время в основном тратится на ожидание отклика от сайта, так что нужно еще делать поправку на качество 
вашего интернет-соединения). 
Кроме того, загрузка cbonds может занимать некоторое время.

*******************************************************************************************************************************************************************************************************************
Подключение

Для подключения модуля убедитесь, что у вас в наличии все перечисленные библиотеки (большинство из них встроенные или имеются в сборке anacondas),
скачайте py-файл, затем введите команду: 

import cbondsdw 

Для этого файл должен находится либо в той же папке, что и исполняемый код, либо в папке с остальными модулями 

*******************************************************************************************************************************************************************************************************************
Функции

Модуль предоставляет следующие функции (не считая чисто служебных): 


1. open_cbonds(login = "isdublenskiy@edu.hse.ru", password = "1234567890", begin = "01.01.2015", end = "31.12.2020", newdriver = True, executable_path = r"chromedriver.exe")

Открывает сайт Cbonds, логинится, нажимает кнопку с первым сохраненным запросом (в нем нужно заранее подготовить все желаемые значения, 
кроме дат и имени бонда), выставляет нужные даты. Аргументы отвечают за следующие значения:
begin, end - даты начала и конца
login, password - данные учетной записи
newdriver - необходимо ли открыть новое окно или просто обновить старое
executable_path - путь к chromedriver

*******************************************************************************************************************************************************************************************************************
2. dates_correct(begin = "01.01.2015", end = "31.12.2020")
Выставляет нужные даты. Значения аргументов см. выше

*******************************************************************************************************************************************************************************************************************
3. PrimaryDownloadCbonds(bondlist, login = "isdublenskiy@edu.hse.ru", password = "1234567890", begin = "01.01.2015", end = "31.12.2020", executable_path = r"chromedriver.exe", bigbondlist = [], pause = False)
ВСПОМОГАТЕЛЬНАЯ ФУНКЦИЯ. Загружает данные в описанном в преамбуле формате. Рекомендуется применять только для коротких списков при недостатке времени, тк. может пропускать
часть дат. Аргументы отвечают за следующее:

bondlist - список интересующих вас облигаций. Принимает только списки, в ином случае используйте функцию list() при введении значения.

bigbondlist - весь список облигаций, номер облигации в котором будет возвращать функция, начиная обрабатывать каждую облигацию из bondlist. 
По умолчанию равен bondlist.

Pause - аргумент, позволяющий добавить дополнительные рандомизированные паузы между итерациями. Каждую итерацию будет добавляться период ожидания от 0 до значения аргумента (в секундах), каждые 30 итераций - от нуля до 4 значений аргумента, каждый 100 - от нуля до 20 значений. Это удлинняет процесс поиска, зато уменьшает (гипотетически) вероятность обнаружения автоматизации администрацией.

Значения остальных аргументов см. в функциях выше.

Возвращает функция список из четырех списков, далее по индексам в большом списке: 
[0] - имена всех обработанных облигаций
[1] - вектор Булевых значений такой же длины, где True означает, что для облигации не было найдено результатов
[2] - вектор Булевых значений такой же длины, где True означает, что для облигации было найдено более 2500 результатов и cbonds выдал ошибку
[3] - вектор имен облигаций, для которых была получена неизвестная ошибка

*******************************************************************************************************************************************************************************************************************
4. RepeatDownloadCbonds(bondlist, login = "isdublenskiy@edu.hse.ru", password = "1234567890", begin = "01.01.2015", end = "31.12.2020", executable_path = r"chromedriver.exe", bigbondlist = [], path = "C://Users//Fride//Downloads")

Основная функция. Загружает данные для списка bondlist облигаций, при этом повторяет операцию для облигаций, вернувших неизвестную ошибку, пока они не закончатся или их число не перестанет сокращаться. Сохраняет в папке, указанной в path три текстовых файла: 

found_nothing<time> - имена облигаций, для которых ничего не было найдено
found_too_much<time> - имена облигаций, для которых было найдено более 2500 значений и которые поэтому не удалось обработать
bad_names<time> - имена облигаций, вернувшиъ неизвестную ошибку, не исправившуюся после нескольих попыток

Значения аргументов: 

path - путь, по которому будут сохранены текстовые файлы

Значения остальных аргументов см. в функциях выше

*******************************************************************************************************************************************************************************************************************
5. LongListDownloadCbonds(bondlist, login = "isdublenskiy@edu.hse.ru", password = "1234567890", begin = "01.01.2015", end = "31.12.2020", executable_path = r"chromedriver.exe", bigbondlist = [], path = "C://Users//Fride//Downloads")

Применяет функцию RepeatDownloadCbonds, разбив список на подсписки длиной максимум по 50 элементов. Применять для длинных списков, чтобы прерывание функции по внешним причинам не повлекло несохранение текстовых файлов с отчетами. 

Значения всех аргументов см. выше.

*******************************************************************************************************************************************************************************************************************
При работе любой из функций сначала откроется окно chrome (если оно не было заранее открыто одной из функций этого модуля) и в нем начнется работа управляемая драйвером. 
Окно можно свернуть, но не закрывать: при попытке закрытия программа снова попытается его открыть и неизвестно, кто выйдет победителем в этой схватке человека и
машины. Прервать функцию можно из IDE. Функция будет выводить подробную информацию о текущем этапе процесса реализации. В процессе работы браузер может произвольно закрываться и открываться заново, иногда многократно - это нормально.

Если функция сразу же вернула ошибку, можно попробовать закрыть окно Chrome и применить ее снова. При повторной ошибке, ошибке после некоторого времени работы или других затруднениях можно связаться со мной по адресу ivandubls18@gmail.com, в мессенджерах по телефону 89685360027 или ВК (отвечу быстрее всего) по адресу https://vk.com/dublensky

Для работы необходима учетная запись cbonds. Можно использовать мою, она активна до весны, однако для использования нужно будет редактировать сохраненный запрос Main;
Пожалуйста, уточняйте, не нужен ли сохраненный запрос кому-то еще (и проверяйте, не отредактировали ли его с вашего прошлого использования). 

Приятного использования!

